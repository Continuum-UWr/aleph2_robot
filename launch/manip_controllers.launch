<launch>
    <arg name="output" default="screen"/>
    <arg name="loop_rate" default="30"/>

    <group ns="manip">

        <rosparam file="$(find aleph2_hardware_interface)/config/manip/joints.yaml" command="load"/>
        <rosparam file="$(find aleph2_hardware_interface)/config/manip/controllers.yaml" command="load"/>
        <rosparam file="$(find aleph2_hardware_interface)/config/manip/joint_limits.yaml" command="load"/>

        <node name="control_loop" pkg="aleph2_hardware_interface" type="control_loop"
                output="$(arg output)">
            <param name="loop_rate" value="$(arg loop_rate)"/>
        </node>

        <node name="effort_controller_spawner" pkg="controller_manager" type="spawner" output="$(arg output)" args="
            controllers/effort/base
            controllers/effort/shoulder
            controllers/effort/elbow
            controllers/effort/wrist_tilt
            controllers/effort/wrist_roll
            controllers/effort/gripper
            controllers/state
        "/>

        <node name="velocity_controller_spawner" pkg="controller_manager" type="spawner" output="$(arg output)" args="
            --stopped
            controllers/velocity/base
            controllers/velocity/shoulder
            controllers/velocity/elbow
            controllers/velocity/wrist_tilt
            controllers/velocity/wrist_roll
            controllers/velocity/gripper
        "/>

        <node name="position_controller_spawner" pkg="controller_manager" type="spawner" output="$(arg output)" args="
            --stopped
            controllers/position/base
            controllers/position/shoulder
            controllers/position/elbow
            controllers/position/wrist_tilt
            controllers/position/wrist_roll
            controllers/position/gripper
        "/>

        <node name="trajectory_controller_spawner" pkg="controller_manager" type="spawner" output="$(arg output)" args="
            --stopped
            controllers/trajectory
        "/>
    </group>

    <node name="manip_joint_state_republisher" pkg="aleph2_hardware_interface" type="joint_state_republisher" output="$(arg output)">
        <param name="source_topic" value="manip/joint_states"/>
    </node>
</launch>
